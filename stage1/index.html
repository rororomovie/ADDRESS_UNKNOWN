<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>—</title>

<style>
  body{
    font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
                 "Liberation Mono", "Courier New", monospace;
    padding: 18px;
    line-height: 1.9;
    background: #fff;
    color: #000;
  }
  pre{
    white-space: pre-wrap;
    margin: 0;
  }
  a{
    color: inherit;
    text-decoration: none;
    cursor: text;
  }
  a:hover,
  a:visited,
  a:active{
    color: inherit;
    text-decoration: none;
  }
</style>

<pre id="text">loading...</pre>

<script>
(async () => {
  try{
    const res = await fetch("Undelivered_letter.txt", { cache: "no-store" });
    const raw = await res.text();

    const target = "――宛所に尋ねあたりません。";
    const container = document.getElementById("text");
    container.textContent = ""; // 初期化

    if(raw.includes(target)){
      const parts = raw.split(target);

      // 前半
      container.append(document.createTextNode(parts[0]));

      // リンク化される部分
      const link = document.createElement("a");
      link.href = "../decrypt.html";
      link.textContent = target;
      link.setAttribute("aria-label", "次のページへ");
      container.append(link);

      // 後半（念のため）
      container.append(document.createTextNode(parts.slice(1).join(target)));
    }else{
      // 対象文字列がなければそのまま表示
      container.textContent = raw;
    }

  }catch(e){
    document.getElementById("text").textContent = "undelivered";
  }
})();
</script>
